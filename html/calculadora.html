<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Recursos</title>
    <link rel="stylesheet" href="../css/calcul.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Alata&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Alata&family=Raleway:ital,wght@0,100..900;1,100..900&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;400;700&display=swap" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/1584cc6a34.js" crossorigin="anonymous"></script>
</head>

<body>
    <script src="../js/teste.js"></script>

    <!-- Se precisar do seu JS externo para o modal, acessibilidade etc, inclui aqui -->
    <script src="../js/navbar.js"></script>
    <meu-navbar></meu-navbar>
    <main>
        <section class="hero-banner">
            <div class="conteudo-banner">
                <img src="../imagens/calcu.png" alt="Imagem Hero" class="hero-image" />
                <a href="#formulario" class="botao">
                    Começar simulação agora <i class="bi bi-arrow-down-right"></i>
                </a>
            </div>
        </section>
        <section class="info">
            <h2>Como é o seu consumo de água?</h2>
            <p>Responda perguntas rápidas sobre seus<br />hábitos e descubra uma estimativa do seu<br />consumo mensal.
            </p>

            <div class="cards">
                <div class="card-1">
                    <i class="bi bi-patch-question-fill"></i><br />
                    <h3>Por que usar?</h3><br />
                    <p>Simule seu consumo<br /> de água e identifique <br /> onde estão os maiores <br /> desperdícios
                        no seu<br /> dia a dia.
                    </p>
                </div>
                <div class="card-1">
                    <i class="bi bi-gear-fill"></i><br />
                    <h3>Como funciona?</h3><br />
                    <p>Responda perguntas<br /> rápidas. A calculadora <br /> estima seu consumo <br /> mensal com base
                        nos<br /> hábitos.
                    </p>
                </div>
                <div class="card-1">
                    <i class="bi bi-rocket-takeoff-fill"></i><br />
                    <h3>O que você ganha?</h3><br />
                    <p>Consciência ambiental, <br /> economia na conta e <br /> ações práticas para um <br /> futuro
                        mais sustentável.
                    </p>
                </div>
            </div>
        </section>
        <section class="chamada-central">
            <h2>Confira agora sua estimativa!</h2>
        </section>

        <hr class="divisor" />

        <section class="explicacao-final">
            <div class="conteudo-explicacao">
                <h2>Calcule com consciência</h2>
                <p>Veja como atitudes simples afetam seu consumo mensal.</p>
            </div>
        </section>


        <div class="form-group" id="formulario" style="font-family: 'Alata', sans-serif;">

            <!-- Linha 1: Pessoas + Lava louça com torneira -->
            <div class="linha">
                <div class="campo">
                    <label>Quantas pessoas vivem na sua casa?</label>
                    <div id="pessoas">
                        <button type="button" onclick="setPessoas(event,1)">1</button>
                        <button type="button" onclick="setPessoas(event,2)">2</button>
                        <button type="button" onclick="setPessoas(event,3)">3</button>
                        <button type="button" onclick="setPessoas(event,4)">4</button>
                        <button type="button" onclick="setPessoas(event,5)">5 +</button>
                    </div>
                </div>

                <div class="campo">
                    <label>Lava louça com torneira aberta?</label><br />
                    <div class="radio-group">
                        <label class="radio-wrapper">
                            <input type="radio" name="lavaLouca" value="sim" onclick="mostrarLouca(true)" />
                            <span class="custom-radio"><i class="bi bi-check"></i></span>
                            <span style="font-family: 'Alata', sans-serif;">Sim</span>
                        </label>
                        <label class="radio-wrapper">
                            <input type="radio" name="lavaLouca" value="nao" onclick="mostrarLouca(false)" />
                            <span class="custom-radio"><i class="bi bi-check"></i></span>
                            <span style="font-family: 'Alata', sans-serif;">Não</span>
                        </label>
                    </div>

                    <div id="tempoLoucaContainer" class="hidden">
                        <label>Tempo médio lavando louça (min)</label>
                        <input type="range" id="tempoLouca" min="1" max="20" value="10"
                            oninput="this.nextElementSibling.innerText = this.value + ' min'" />
                        <span>10 min</span>
                    </div>
                </div>
            </div>

            <!-- Linha 2: Descargas + Lava o carro -->
            <div class="linha">
                <div class="campo coluna-esquerda">
                    <label>Descargas por dia (média total)</label>
                    <input type="number" id="descargas" min="0" placeholder="Insira um número" />
                </div>

                <div class="campo">
                    <div class="label-select-container">
                        <label>Lava o carro?</label>
                        <div id="metodoCarroContainer" class="hidden">
                            <label style="font-family: 'Alata', sans-serif;">Método:</label>
                            <select id="metodoCarro" style="font-family: 'Alata', sans-serif;">
                                <option value="mangueira">Mangueira</option>
                                <option value="balde">Balde</option>
                            </select>
                        </div>
                    </div>

                    <div class="radio-group" style="margin-top: 0.5rem;">
                        <label class="radio-wrapper">
                            <input type="radio" name="lavaCarro" value="sim" onclick="mostrarCarro(true)" />
                            <span class="custom-radio"><i class="bi bi-check"></i></span>
                            <span style="font-family: 'Alata', sans-serif;">Sim</span>
                        </label>
                        <label class="radio-wrapper">
                            <input type="radio" name="lavaCarro" value="nao" onclick="mostrarCarro(false)" />
                            <span class="custom-radio"><i class="bi bi-check"></i></span>
                            <span style="font-family: 'Alata', sans-serif;">Não</span>
                        </label>
                    </div>
                </div>
            </div>

            <!-- Linha 3: Tempo de banho + Quantas vezes lava louça -->
            <div class="linha">
                <div class="campo">
                    <label for="tempoBanho">Tempo médio de banho por pessoa (min)</label>
                    <input type="range" id="tempoBanho" min="5" max="25" step="5" value="10"
                        oninput="atualizarValor('tempoBanho', 'valorBanho')" />
                    <div class="range-labels">
                        <span style="font-family: 'Alata', sans-serif;">5</span>
                        <span style="font-family: 'Alata', sans-serif;">10</span>
                        <span style="font-family: 'Alata', sans-serif;">15</span>
                        <span style="font-family: 'Alata', sans-serif;">20</span>
                        <span style="font-family: 'Alata', sans-serif;">25+</span>
                    </div>
                    <span id="valorBanho" style="font-family: 'Alata', sans-serif;">10 min</span>
                </div>

                <div class="campo">
                    <label>Quantas vezes lava louça por dia?</label>
                    <input type="number" id="vezesLouca" min="0" placeholder="Insira um número" />
                </div>
            </div>

            <!-- Linha 4: Botão -->
            <div class="linha">
                <div class="campo" style="flex: 1; text-align: right;">
                    <button onclick="calcular()" style="margin-top: 30px;">CALCULAR</button>
                </div>
            </div>
        </div>

        <div id="relatorioContainer"></div>

        <div id="modalResultado" class="modal hidden">

            <!-- Header azul com ícone -->
            <div class="modal-header-custom">
                <img src="../imagens/globo1.png" alt="Ícone do globo" class="modal-icon-img">
            </div>

            <!-- Botão de fechar -->
            <button class="modal-close" onclick="fecharModal()">
                <i class="bi bi-x"></i>
            </button>

            <!-- Conteúdo principal -->
            <div class="modal-body">
                <h3>Seu resultado de Consumo:</h3>
                <p class="descricao" style="text-align: left;">Veja sua estimativa mensal com base nas suas respostas.
                </p>
                <p class="descricao" style="font-weight: bold;">Você consome aproximadamente:</p>
                <p class="valor">
                    <i class="bi bi-droplet-half"></i>
                    <strong id="resultadoModal">0 litros por mês</strong>
                </p>
                <p id="tipoConsumo">
                    <span style="font-weight: bold;">Tipo de consumo:</span>
                    <span id="nivelConsumo">moderado.</span>
                </p>
                <div class="modal-buttons">
                    <button id="btnGerarPDF" class="btn gerar-pdf">Gerar PDF</button>
                    <button class="btn refazer" onclick="location.reload();">Refazer cálculo</button>

                </div>
            </div>
        </div>

        <div id="overlay" class="overlay hidden"></div>



        <div class="resultado hidden" id="resultadoFinal">

            <div style="text-align: center; font-family: 'Poppins';">
                <p class="text-explorar">Quer explorar mais? Veja o que você pode fazer com esse resultado:</p>

                <button class="btn-analisar">Analisar Resultado</button>
                <button class="btn refazer" onclick="location.reload();">Refazer cálculo</button>

            </div>
        </div>


        <hr class="linha-3" />
        <div class="fazer-login">
            <div class="entre-agora">
                <p>
                    Entre agora e transforme o futuro <br />
                    da água com a gente!
                </p>
            </div>
            <button class="login-btn">
                <a href="login.html" class="none">
                    <p>Fazer login</p>
                </a>
            </button>
        </div>
        <div class="rodape" style="font-family: 'Poppins';">
            <hr id="linha-3" />
            <div class="sustentabilidade">
                <div class="texto">
                    <h1>
                        Sustentabilidade que se adapta,<br />
                        tecnologia que evolui.
                    </h1>
                    <p>2025, Aquatech.</p>
                </div>
                <div class="linha-e-links" style="margin-left: 40%;">
                    <div class="linha-vertical"></div>
                    <div class="menu-links">
                        <p class="titulo-menu" style="margin-left: auto;">Conheça a Plataforma</p>
                        <a href="#">Home</a>
                        <a href="#">Quem somos</a>
                        <a href="#">Recursos</a>
                        <a href="#">Soluções</a>
                    </div>
                </div>
            </div>
            <footer class="footer">
                <div class="social-media">
                    <i class="fa-brands fa-instagram"></i>
                    <i class="fa-brands fa-x-twitter"></i>
                    <i class="fa-brands fa-facebook"></i>
                </div>
                <img src="../imagens/logobr.png" alt="logo_aquatech" class="logo" />
                <p class="copyright">© 2025 Aquatech.</p>
            </footer>
        </div>


        <script>
            let pessoas = 1;

            function setPessoas(event, qtd) {
                pessoas = qtd;
                const botoes = document.querySelectorAll('#pessoas button');
                botoes.forEach(btn => {
                    btn.classList.remove('selected');
                });
                event.target.classList.add('selected');
            }

            function mostrarLouca(show) {
                document.getElementById('tempoLoucaContainer').classList.toggle('hidden', !show);
            }

            function mostrarCarro(show) {
                document.getElementById('metodoCarroContainer').classList.toggle('hidden', !show);
            }

            function calcular() {
                // VALIDAÇÕES INICIO
                if (!pessoas || pessoas < 1) {
                    alert("Por favor, selecione o número de pessoas.");
                    return;
                }

                const banhoInput = document.getElementById('tempoBanho');
                if (!banhoInput.value || Number(banhoInput.value) < 1) {
                    alert("Por favor, informe o tempo do banho.");
                    return;
                }

                const escovarInput = document.getElementById('tempoEscovar');
                if (escovarInput && (!escovarInput.value || Number(escovarInput.value) < 0)) {
                    alert("Por favor, informe o tempo de escovação.");
                    return;
                }

                const descargasInput = document.getElementById('descargas');
                if (!descargasInput.value || Number(descargasInput.value) < 0) {
                    alert("Por favor, informe o número de descargas.");
                    return;
                }

                const lavaLoucaChecked = document.querySelector('input[name="lavaLouca"]:checked');
                if (!lavaLoucaChecked) {
                    alert("Por favor, selecione se lava louça.");
                    return;
                }

                if (lavaLoucaChecked.value === 'sim') {
                    const tempoLoucaInput = document.getElementById('tempoLouca');
                    if (!tempoLoucaInput.value || Number(tempoLoucaInput.value) < 1) {
                        alert("Por favor, informe o tempo lavando louça.");
                        return;
                    }
                }

                const vezesLoucaInput = document.getElementById('vezesLouca');
                if (!vezesLoucaInput.value || Number(vezesLoucaInput.value) < 0) {
                    alert("Por favor, informe quantas vezes lava louça.");
                    return;
                }

                const lavaCarroChecked = document.querySelector('input[name="lavaCarro"]:checked');
                if (!lavaCarroChecked) {
                    alert("Por favor, selecione se lava carro.");
                    return;
                }

                if (lavaCarroChecked.value === 'sim') {
                    const metodoCarroSelect = document.getElementById('metodoCarro');
                    if (!metodoCarroSelect.value) {
                        alert("Por favor, selecione o método de lavar carro.");
                        return;
                    }
                }
                // VALIDAÇÕES FIM

                // SE CHEGOU AQUI, TODOS OS CAMPOS ESTÃO VÁLIDOS
                const banho = Number(document.getElementById('tempoBanho').value);
                const escovar = escovarInput ? Number(escovarInput.value) : 0;
                const descargas = Number(descargasInput.value);
                const vezesLouca = Number(vezesLoucaInput.value);

                const lavaLouca = lavaLoucaChecked.value === 'sim';
                const tempoLouca = lavaLouca ? Number(document.getElementById('tempoLouca').value) : 0;

                const lavaCarro = lavaCarroChecked.value === 'sim';
                const metodoCarro = lavaCarro ? document.getElementById('metodoCarro').value : '';

                let consumo = 0;
                consumo += pessoas * banho * 12 * 30;
                consumo += escovar * 4 * pessoas * 30;
                consumo += descargas * 12;
                consumo += tempoLouca * vezesLouca * 30;
                if (lavaCarro && metodoCarro === 'mangueira') consumo += 500;
                else if (lavaCarro && metodoCarro === 'balde') consumo += 100;

                // Ajustando os tipos para corresponder ao que quer:
                const tipo = consumo < 5000 ? 'Baixo' : consumo < 10000 ? 'Médio' : 'Alto';

                // Exibir resultado no modal
                document.getElementById('resultadoModal').innerText = consumo.toLocaleString() + ' litros por mês.';
                document.getElementById('tipoConsumo').innerText = 'Tipo de consumo: ' + tipo;
                document.getElementById('modalResultado').classList.remove('hidden');
                document.getElementById('overlay').classList.remove('hidden');

                // Guardar resultado globalmente
                window._resultadoConsumo = { consumo, tipo };
            }

            function fecharModal() {
                document.getElementById('modalResultado').classList.add('hidden');
                document.getElementById('overlay').classList.add('hidden');

                const r = window._resultadoConsumo;
                if (!r) return;

                // Criar o bloco de dica baseado no tipo de consumo
                let dica = "";

                if (r.tipo === "Baixo") {
                    dica = `
            <div class="card">
                <strong> Mantenha seus hábitos</strong>
                <p>Você já está no caminho certo, continue consciente!</p>
            </div>
            <div class="card">
                <strong> Compartilhe boas práticas</strong>
                <p>Incentive familiares e amigos a economizar também.</p>
            </div>
            <div class="card">
                <strong> Compartilhe boas práticas</strong>
                <p>Incentive familiares e amigos a economizar também.</p>
            </div>
        `;
                } else if (r.tipo === "Médio") {
                    dica = `
            <div class="card">
                <strong> Reduza o tempo do banho</strong>
                <p>Banhos curtos economizam muita água.</p>
            </div>
            <div class="card">
                <strong> Reutilize a água</strong>
                <p>Use a água da máquina de lavar para limpar o quintal ou calçada.</p>
            </div>
            <div class="card">
                <strong>Reutilize a água</strong>
                <p>Use a água da máquina de lavar para limpar o quintal ou calçada.</p>
            </div>
        `;
                } else if (r.tipo === "Alto") {
                    dica = `
            <div class="card">
                <strong> Verifique vazamentos</strong>
                <p>Torneiras pingando gastam litros por dia.</p>
            </div>
            <div class="card">
                <strong> Feche a torneira</strong>
                <p>Escove os dentes com a torneira sempre fechada.</p>
            </div>
            <div class="card">
                <strong> Use balde</strong>
                <p>Ao lavar o carro ou calçada, evite mangueiras.</p>
            </div>
        `;
                }

                // Exibir o resultado com as dicas no elemento resultadoFinal
                document.getElementById('resultadoFinal').innerHTML = `
        <div class="caixa-resultado">
            <h3>Você consome aproximadamente:</h3>
            <div class="consumo-mensal">
                <i class="bi bi-droplet"></i> ${r.consumo.toLocaleString()} litros por mês
            </div>

            <h4>Dicas personalizadas:</h4>
            <div class="dicas">
                ${dica}
            </div>

            <p class="tipo-consumo">
                <strong>Tipo de consumo:</strong> ${r.tipo.toLowerCase()}
            </p>
        </div>
                    <div style="text-align: center; font-family: 'Poppins';">
                    <p class="text-explorar">Quer explorar mais? Veja o que você pode fazer com esse resultado:</p>

                    <button class="btn relatorio" onclick="location.hash='relatorioContainer';">Ver Relatório</button>

                    <button class="btn refazer" onclick="location.reload();">Refazer cálculo</button>
    `;

                document.getElementById('resultadoFinal').classList.remove('hidden');
            }


            window.addEventListener('DOMContentLoaded', () => {
                // Inicializa o botão de pessoas e o slider de banho
                const btnInicial = document.querySelector('#pessoas button');
                if (btnInicial) {
                    btnInicial.classList.add('selected');
                }

                const banhoSlider = document.getElementById('tempoBanho');
                const valorBanho = document.getElementById('valorBanho');

                function atualizarValorBanho() {
                    const valor = Number(banhoSlider.value);
                    valorBanho.textContent = valor >= 25 ? '25+' : valor;
                }

                banhoSlider.addEventListener('input', atualizarValorBanho);
                atualizarValorBanho(); // valor inicial

                // Função para gerar o HTML do relatório
                function gerarRelatorioHTML(r) {
                    let dica = "";
                    if (r.tipo === "Baixo") {
                        dica = `
            <ul>
                <li><strong>✅ Mantenha seus hábitos:</strong> Você já está no caminho certo, continue consciente!</li>
                <li><strong>✅ Compartilhe boas práticas:</strong> Incentive familiares e amigos a economizar também.</li>
            </ul>`;
                    } else if (r.tipo === "Médio") {
                        dica = `
            <ul>
                <li><strong>🚿 Reduza o tempo do banho:</strong> Banhos curtos economizam muita água.</li>
                <li><strong>♻️ Reutilize a água:</strong> Use a água da máquina de lavar para limpar o quintal ou calçada.</li>
            </ul>`;
                    } else if (r.tipo === "Alto") {
                        dica = `
            <ul>
                <li><strong>🔧 Verifique vazamentos:</strong> Torneiras pingando gastam litros por dia.</li>
                <li><strong>🪥 Feche a torneira:</strong> Escove os dentes com a torneira fechada sempre.</li>
                <li><strong>🪣 Use balde:</strong> Ao lavar o carro ou calçada, evite mangueiras.</li>
            </ul>`;
                    }

                    const html = `
            <div id="relatorio" style="font-family: Arial, sans-serif; padding: 40px; max-width: 800px; margin: auto;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <img src="../imagens/logobl.png" alt="Logo Aquatech" style="height: 40px;">
                    <div style="text-align: right;">
                        <strong>Data do Relatório:</strong><br>
                        <span>${r.data}</span>
                    </div>
                </div>

                <h2 style="margin-top: 40px;">RELATÓRIO<br><span style="font-weight: bold;">DE CONSUMO DE ÁGUA</span></h2>

                <h3>RESUMO GERAL:</h3>
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 30px;">
                    <thead>
                        <tr>
                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">INDICADOR</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: left;">RESULTADO</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="border: 1px solid #000; padding: 8px;">Consumo mensal estimado</td>
                            <td style="border: 1px solid #000; padding: 8px;">${r.consumo}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #000; padding: 8px;">Classificação</td>
                            <td style="border: 1px solid #000; padding: 8px;">${r.tipo}</td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid #000; padding: 8px;">Pessoas na residência</td>
                            <td style="border: 1px solid #000; padding: 8px;">${r.pessoas} pessoas</td>
                        </tr>
                    </tbody>
                </table>

                <h3>OBSERVAÇÕES:</h3>
                <p>Comportamento analisado com base nos hábitos informados.</p>

                <h3>DESTAQUES DO CONSUMO:</h3>
                <ul style="margin-bottom: 30px;">
                    <li>Banhos prolongados: média de ${r.banho} minutos.</li>
                    <li>Descargas: ${r.descargas} vezes por dia.</li>
                    <li>Lavagem de louça: ${r.louca} minutos com torneira aberta.</li>
                    <li>${r.carro}</li>
                </ul>

                <h3>DICAS PERSONALIZADAS:</h3>
                ${dica}

                <p style="text-align: right; margin-top: 50px;"><strong>2025, Aquatech.</strong></p>
            </div>`;

                    document.getElementById('relatorioContainer').innerHTML = html;
                }

                // Função que monta o relatório a partir dos inputs
                function montarRelatorio() {
                    const escovarInput = document.getElementById('tempoEscovar');
                    const descargasInput = document.getElementById('descargas');
                    const lavaLoucaChecked = document.querySelector('input[name="lavaLouca"]:checked');
                    const tempoLoucaInput = document.getElementById('tempoLouca');
                    const vezesLoucaInput = document.getElementById('vezesLouca');
                    const lavaCarroChecked = document.querySelector('input[name="lavaCarro"]:checked');
                    const metodoCarroSelect = document.getElementById('metodoCarro');

                    const banho = Number(document.getElementById('tempoBanho').value);
                    const escovar = escovarInput ? Number(escovarInput.value) : 0;
                    const descargas = Number(descargasInput.value);
                    const vezesLouca = Number(vezesLoucaInput.value);

                    const lavaLouca = lavaLoucaChecked?.value === 'sim';
                    const tempoLouca = lavaLouca ? Number(tempoLoucaInput.value) : 0;

                    const lavaCarro = lavaCarroChecked?.value === 'sim';
                    const metodoCarro = lavaCarro ? metodoCarroSelect.value : '';
                    const carroTexto = lavaCarro
                        ? metodoCarro === 'mangueira'
                            ? 'Lava o carro com mangueira.'
                            : metodoCarro === 'balde'
                                ? 'Lava o carro com balde.'
                                : 'Lava o carro.'
                        : 'Não lava o carro.';

                    let consumo = 0;
                    consumo += pessoas * banho * 12 * 30;
                    consumo += escovar * 4 * pessoas * 30;
                    consumo += descargas * 12;
                    consumo += tempoLouca * vezesLouca * 30;
                    if (lavaCarro && metodoCarro === 'mangueira') consumo += 500;
                    else if (lavaCarro && metodoCarro === 'balde') consumo += 100;

                    const tipo = consumo < 5000 ? 'Baixo' : consumo < 10000 ? 'Médio' : 'Alto';

                    return {
                        data: new Date().toLocaleDateString(),
                        consumo: `${consumo.toLocaleString()} Litros`,
                        tipo,
                        pessoas,
                        banho,
                        descargas,
                        louca: tempoLouca,
                        carro: carroTexto
                    };
                }

                // Geração do PDF
                document.getElementById('btnGerarPDF').addEventListener('click', () => {
                    const relatorio = montarRelatorio();

                    // Gera o HTML do relatório
                    gerarRelatorioHTML(relatorio);

                    // Verifica se o relatório está visível
                    setTimeout(() => {
                        const element = document.getElementById('relatorio');

                        // Checa se o elemento do relatório está no DOM
                        if (!element) {
                            console.log('Relatório não encontrado!');
                            alert('Elemento do relatório não encontrado!');
                            return;  // Impede a geração do PDF
                        }

                        // Verifica a visibilidade do relatório
                        const visibility = window.getComputedStyle(element).visibility;
                        const display = window.getComputedStyle(element).display;

                        if (visibility === 'hidden' || display === 'none') {
                            console.log('Relatório não está visível!');
                            alert('O relatório não está visível, verifique os estilos aplicados!');
                            return;  // Impede a geração do PDF
                        }

                        // Log para confirmar que tudo está correto
                        console.log('Relatório renderizado corretamente!');
                        console.log('Visibilidade:', visibility);
                        console.log('Display:', display);

                        // Gerar o PDF a partir do elemento renderizado
                        const options = {
                            margin: 0.5,
                            filename: 'relatorio_consumo_agua.pdf',
                            image: { type: 'jpeg', quality: 0.98 },
                            html2canvas: { scale: 2 },
                            jsPDF: { unit: 'in', format: 'a4', orientation: 'portrait' }
                        };

                        html2pdf().set(options).from(element).toPdf().get('pdf').then((pdf) => {
                            console.log('PDF gerado, mas não baixado!');
                            // Se quiser exibir o PDF na tela, pode fazer assim:
                            // const blob = pdf.output('blob');
                            // const url = URL.createObjectURL(blob);
                            // window.open(url);
                        });

                    }, 1000); // Atraso de 1000ms para garantir que o relatório foi renderizado
                });
            });


        </script>



    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>


    <!-- Se precisar do seu JS externo para o modal, acessibilidade etc, inclui aqui -->
    <script src="../js/navbar.js"></script>
</body>

</html>